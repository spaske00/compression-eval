#!/bin/python3

import sklearn
import numpy as np
import matplotlib.pyplot as plt
import pandas as pd
import sys

for csv in sys.argv[1:]:

    df = pd.read_csv(csv)

    def corr(a, b):
        return a.corr(b)
    
    compressors = df['Compressor name'].unique()

    # Unused
    df = df.drop('Filename', axis=1)
    # df = df.drop('Compressor name', axis=1)

    cols = df.columns[1:]
    n = len(cols)

    print(f' --- {csv} --- ')
    for comp in compressors:
        f = df[df['Compressor name'] == comp]
        for i in range(n):
            c1 = cols[i]
            if str(c1) == 'Compressor name':
                continue
            for j in range(i + 1, n):
                c2 = cols[j]
                if str(c2) == 'Compressor name':
                    continue
                print(str(comp).ljust(20), ' | ', str(c1).rjust(20, ' '), ' | ', str(c2).ljust(20, ' '), ' | ', end='')
                c = corr(f[c1], f[c2])
                print(f'{c:+2.5f}', end='')

                # indicator
                if abs(c) > 0.8:
                    print('\t<===', end='')
                elif abs(c) > 0.5:
                    print('\t<---', end='')

                print()
    print()

