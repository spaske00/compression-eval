#!/bin/bash
#shellcheck disable=SC2164

cc="$1"
cxx="$2"
target="${3#"jq-"}"
shift 3
cflags="$@"

jq_root="$PWD"
mkdir -p bin/

cd ./jq-1.8.1
autoreconf -fi
./configure --without-oniguruma CC="$cc" CXX="$cxx" CLAGS="$cflags"
make clean
make -j8
target_dir="$jq_root/bin/jq-${target%.out}/" 
mkdir -p "$target_dir"
mv ./libs/jq "$target_dir/${target%.out}"

unset cc
unset cxx
unset target
unset cflags
unset jq_root

